<mxfile host="app.diagrams.net" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/116.0.0.0 Safari/537.36" version="29.2.9">
  <diagram name="第 1 页" id="koUY-GKG6jGSpLQKiAwZ">
    <mxGraphModel dx="1924" dy="581" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="swAobIZYqp8_NzoMnOO4-1" parent="1" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;container=1;dropTarget=0;collapsible=0;recursiveResize=0;outlineConnect=0;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;vertical&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0};size=65;" value="&quot;用户请求&#xa;(User Request)&quot;" vertex="1">
          <mxGeometry height="1792" width="150" x="-160" y="20" as="geometry" />
        </mxCell>
        <mxCell id="swAobIZYqp8_NzoMnOO4-2" parent="1" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;container=1;dropTarget=0;collapsible=0;recursiveResize=0;outlineConnect=0;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;vertical&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0};size=65;" value="&quot;recall-service&#xa;(检索服务)&quot;" vertex="1">
          <mxGeometry height="1792" width="150" x="40" y="20" as="geometry" />
        </mxCell>
        <mxCell id="swAobIZYqp8_NzoMnOO4-3" parent="1" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;container=1;dropTarget=0;collapsible=0;recursiveResize=0;outlineConnect=0;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;vertical&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0};size=65;" value="recall-job&#xa;OverseasRegionProcessor" vertex="1">
          <mxGeometry height="1792" width="217" x="420" y="20" as="geometry" />
        </mxCell>
        <mxCell id="swAobIZYqp8_NzoMnOO4-4" parent="1" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;container=1;dropTarget=0;collapsible=0;recursiveResize=0;outlineConnect=0;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;vertical&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0};size=65;" value="recall-job&#xa;LowValueDataCache" vertex="1">
          <mxGeometry height="1792" width="214" x="687" y="20" as="geometry" />
        </mxCell>
        <mxCell id="swAobIZYqp8_NzoMnOO4-5" parent="1" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;container=1;dropTarget=0;collapsible=0;recursiveResize=0;outlineConnect=0;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;vertical&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0};size=65;" value="Data Redis" vertex="1">
          <mxGeometry height="1792" width="150" x="1127" y="20" as="geometry" />
        </mxCell>
        <mxCell id="swAobIZYqp8_NzoMnOO4-6" parent="1" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;container=1;dropTarget=0;collapsible=0;recursiveResize=0;outlineConnect=0;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;vertical&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0};size=65;" value="数开" vertex="1">
          <mxGeometry height="1792" width="150" x="1516" y="20" as="geometry" />
        </mxCell>
        <mxCell id="swAobIZYqp8_NzoMnOO4-7" parent="1" style="shape=umlFrame;dashed=1;pointerEvents=0;dropTarget=0;strokeColor=#B3B3B3;height=20;width=0" value="" vertex="1">
          <mxGeometry height="257" width="459" x="1167" y="95" as="geometry" />
        </mxCell>
        <mxCell id="swAobIZYqp8_NzoMnOO4-8" parent="swAobIZYqp8_NzoMnOO4-7" style="text;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;" value="" vertex="1">
          <mxGeometry height="20" width="459" as="geometry" />
        </mxCell>
        <mxCell id="swAobIZYqp8_NzoMnOO4-9" parent="1" style="shape=umlFrame;dashed=1;pointerEvents=0;dropTarget=0;strokeColor=#B3B3B3;height=20;width=30" value="alt" vertex="1">
          <mxGeometry height="294" width="536" x="2060" y="696" as="geometry" />
        </mxCell>
        <mxCell id="swAobIZYqp8_NzoMnOO4-10" parent="swAobIZYqp8_NzoMnOO4-9" style="text;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;" value="[存在上一版本数据]" vertex="1">
          <mxGeometry height="20" width="506" x="30" as="geometry" />
        </mxCell>
        <mxCell id="swAobIZYqp8_NzoMnOO4-11" parent="swAobIZYqp8_NzoMnOO4-9" style="shape=line;dashed=1;whiteSpace=wrap;verticalAlign=top;labelPosition=center;verticalLabelPosition=middle;align=center;strokeColor=#B3B3B3;" value="[不存在上一版本数据]" vertex="1">
          <mxGeometry height="4" width="536" y="204" as="geometry" />
        </mxCell>
        <mxCell id="swAobIZYqp8_NzoMnOO4-12" parent="1" style="shape=umlFrame;dashed=1;pointerEvents=0;dropTarget=0;strokeColor=#B3B3B3;height=20;width=30;" value="loop" vertex="1">
          <mxGeometry height="100" width="460" x="750" y="570" as="geometry" />
        </mxCell>
        <mxCell id="swAobIZYqp8_NzoMnOO4-15" parent="1" style="shape=umlFrame;dashed=1;pointerEvents=0;dropTarget=0;strokeColor=#B3B3B3;height=20;width=0" value="" vertex="1">
          <mxGeometry height="358" width="497" x="740" y="362" as="geometry" />
        </mxCell>
        <mxCell id="swAobIZYqp8_NzoMnOO4-16" parent="swAobIZYqp8_NzoMnOO4-15" style="text;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;" value="" vertex="1">
          <mxGeometry height="8.55436081242533" width="497" as="geometry" />
        </mxCell>
        <mxCell id="swAobIZYqp8_NzoMnOO4-17" parent="1" style="shape=umlFrame;dashed=1;pointerEvents=0;dropTarget=0;strokeColor=#B3B3B3;height=20;width=0" value="" vertex="1">
          <mxGeometry height="173" width="270" x="-120" y="1209" as="geometry" />
        </mxCell>
        <mxCell id="swAobIZYqp8_NzoMnOO4-18" parent="swAobIZYqp8_NzoMnOO4-17" style="text;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;" value="" vertex="1">
          <mxGeometry height="20" width="270" as="geometry" />
        </mxCell>
        <mxCell id="swAobIZYqp8_NzoMnOO4-26" edge="1" parent="1" source="swAobIZYqp8_NzoMnOO4-6" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;endArrow=block;" target="swAobIZYqp8_NzoMnOO4-5" value="写入版本时间戳&#xa;KEY: ad:show:recall:low:conversion:version:list&#xa;TYPE: STRING, TTL: 3d">
          <mxGeometry relative="1" x="-0.001" as="geometry">
            <mxPoint as="offset" />
            <Array as="points">
              <mxPoint x="1408" y="238" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="swAobIZYqp8_NzoMnOO4-27" parent="swAobIZYqp8_NzoMnOO4-26" style="ellipse;aspect=fixed;fillColor=#000000;align=center;fontColor=#FFFFFF;" value="1" vertex="1">
          <mxGeometry height="14" relative="1" width="14" as="geometry">
            <mxPoint x="188" y="-7" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="swAobIZYqp8_NzoMnOO4-28" edge="1" parent="1" source="swAobIZYqp8_NzoMnOO4-6" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;endArrow=block;" target="swAobIZYqp8_NzoMnOO4-5" value="写入低价值广告地区数据&#xa;KEY: ad:show:recall:low:conversion:{version}&#xa;TYPE: HASH, TTL: 3d">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1408" y="332" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="swAobIZYqp8_NzoMnOO4-29" parent="swAobIZYqp8_NzoMnOO4-28" style="ellipse;aspect=fixed;fillColor=#000000;align=center;fontColor=#FFFFFF;" value="2" vertex="1">
          <mxGeometry height="14" relative="1" width="14" as="geometry">
            <mxPoint x="188" y="-7" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="swAobIZYqp8_NzoMnOO4-30" edge="1" parent="1" source="swAobIZYqp8_NzoMnOO4-4" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;endArrow=block;" target="swAobIZYqp8_NzoMnOO4-5" value="获取版本时间戳&#xa;GET ad:show:recall:low:conversion:version:list">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1007" y="484" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="swAobIZYqp8_NzoMnOO4-31" parent="swAobIZYqp8_NzoMnOO4-30" style="ellipse;aspect=fixed;fillColor=#000000;align=center;fontColor=#FFFFFF;" value="3" vertex="1">
          <mxGeometry height="14" relative="1" width="14" as="geometry">
            <mxPoint x="-211.5" y="-7" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="swAobIZYqp8_NzoMnOO4-32" edge="1" parent="1" source="swAobIZYqp8_NzoMnOO4-5" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;dashed=1;dashPattern=2 3;endArrow=block;" target="swAobIZYqp8_NzoMnOO4-4" value="返回版本时间戳">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1010" y="536" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="swAobIZYqp8_NzoMnOO4-33" parent="swAobIZYqp8_NzoMnOO4-32" style="ellipse;aspect=fixed;fillColor=#000000;align=center;fontColor=#FFFFFF;" value="4" vertex="1">
          <mxGeometry height="14" relative="1" width="14" as="geometry">
            <mxPoint x="197.5" y="-7" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="swAobIZYqp8_NzoMnOO4-34" edge="1" parent="1" source="swAobIZYqp8_NzoMnOO4-4" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;endArrow=block;" target="swAobIZYqp8_NzoMnOO4-5" value="获取低价值广告地区数据&#xa;HGETALL ad:show:recall:low:conversion:{version}">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1007" y="609" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="swAobIZYqp8_NzoMnOO4-35" parent="swAobIZYqp8_NzoMnOO4-34" style="ellipse;aspect=fixed;fillColor=#000000;align=center;fontColor=#FFFFFF;" value="5" vertex="1">
          <mxGeometry height="14" relative="1" width="14" as="geometry">
            <mxPoint x="-211.5" y="-7" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="swAobIZYqp8_NzoMnOO4-36" edge="1" parent="1" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;dashed=1;dashPattern=2 3;endArrow=block;" value="返回HASH数据">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1006.6800000000001" y="650" />
            </Array>
            <mxPoint x="1198.18" y="649.9999999999998" as="sourcePoint" />
            <mxPoint x="790.0035294117649" y="649.9999999999998" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="swAobIZYqp8_NzoMnOO4-37" parent="swAobIZYqp8_NzoMnOO4-36" style="ellipse;aspect=fixed;fillColor=#000000;align=center;fontColor=#FFFFFF;" value="6" vertex="1">
          <mxGeometry height="14" relative="1" width="14" as="geometry">
            <mxPoint x="197.5" y="-7" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="swAobIZYqp8_NzoMnOO4-38" edge="1" parent="1" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;endArrow=block;" value="获取上一版本数据">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="2390" y="774" />
            </Array>
            <mxPoint x="2176.323529411765" y="774" as="sourcePoint" />
            <mxPoint x="2584.5" y="774" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="swAobIZYqp8_NzoMnOO4-39" parent="swAobIZYqp8_NzoMnOO4-38" style="ellipse;aspect=fixed;fillColor=#000000;align=center;fontColor=#FFFFFF;" value="7" vertex="1">
          <mxGeometry height="14" relative="1" width="14" as="geometry">
            <mxPoint x="-211.5" y="-7" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="swAobIZYqp8_NzoMnOO4-40" edge="1" parent="1" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;dashed=1;dashPattern=2 3;endArrow=block;" value="返回上一版本数据">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="2393" y="826" />
            </Array>
            <mxPoint x="2584.5" y="826" as="sourcePoint" />
            <mxPoint x="2176.323529411765" y="826" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="swAobIZYqp8_NzoMnOO4-41" parent="swAobIZYqp8_NzoMnOO4-40" style="ellipse;aspect=fixed;fillColor=#000000;align=center;fontColor=#FFFFFF;" value="8" vertex="1">
          <mxGeometry height="14" relative="1" width="14" as="geometry">
            <mxPoint x="197.5" y="-7" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="swAobIZYqp8_NzoMnOO4-42" edge="1" parent="1" style="curved=1;endArrow=block;rounded=0;" value="写入本地缓存">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="2228" y="1078" />
              <mxPoint x="2228" y="1108" />
            </Array>
            <mxPoint x="2176.323529411765" y="1078" as="sourcePoint" />
            <mxPoint x="2176.323529411765" y="1108" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="swAobIZYqp8_NzoMnOO4-43" parent="swAobIZYqp8_NzoMnOO4-42" style="ellipse;aspect=fixed;fillColor=#000000;align=center;fontColor=#FFFFFF;" value="9" vertex="1">
          <mxGeometry height="14" relative="1" width="14" as="geometry">
            <mxPoint x="-57" y="-22" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="swAobIZYqp8_NzoMnOO4-44" edge="1" parent="1" source="swAobIZYqp8_NzoMnOO4-1" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;endArrow=block;" target="swAobIZYqp8_NzoMnOO4-2" value="广告召回请求">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="24" y="1310" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="swAobIZYqp8_NzoMnOO4-45" parent="swAobIZYqp8_NzoMnOO4-44" style="ellipse;aspect=fixed;fillColor=#000000;align=center;fontColor=#FFFFFF;" value="10" vertex="1">
          <mxGeometry height="14" relative="1" width="14" as="geometry">
            <mxPoint x="-107.5" y="-7" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="swAobIZYqp8_NzoMnOO4-46" edge="1" parent="1" source="swAobIZYqp8_NzoMnOO4-2" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;dashed=1;dashPattern=2 3;endArrow=block;" target="swAobIZYqp8_NzoMnOO4-1" value="返回广告列表">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="27" y="1362" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="swAobIZYqp8_NzoMnOO4-47" parent="swAobIZYqp8_NzoMnOO4-46" style="ellipse;aspect=fixed;fillColor=#000000;align=center;fontColor=#FFFFFF;" value="11" vertex="1">
          <mxGeometry height="14" relative="1" width="14" as="geometry">
            <mxPoint x="93.5" y="-7" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="swAobIZYqp8_NzoMnOO4-48" parent="1" style="fillColor=#ffff88;strokeColor=#9E916F;" value="阶段1: 数据写入（每天执行）" vertex="1">
          <mxGeometry height="49" width="439" x="1177" y="115" as="geometry" />
        </mxCell>
        <mxCell id="swAobIZYqp8_NzoMnOO4-49" parent="1" style="fillColor=#ffff88;strokeColor=#9E916F;" value="阶段2: 本地缓存加载" vertex="1">
          <mxGeometry height="49" width="458" x="769" y="382" as="geometry" />
        </mxCell>
        <mxCell id="swAobIZYqp8_NzoMnOO4-50" parent="1" style="fillColor=#ffff88;strokeColor=#9E916F;" value="版本降级：复用上一版本" vertex="1">
          <mxGeometry height="49" width="214" x="2070" y="846" as="geometry" />
        </mxCell>
        <mxCell id="swAobIZYqp8_NzoMnOO4-51" parent="1" style="fillColor=#ffff88;strokeColor=#9E916F;" value="开关降级：清空缓存" vertex="1">
          <mxGeometry height="49" width="214" x="2070" y="941" as="geometry" />
        </mxCell>
        <mxCell id="swAobIZYqp8_NzoMnOO4-52" parent="1" style="fillColor=#ffff88;strokeColor=#9E916F;" value="阶段3: 广告检索（实时请求）" vertex="1">
          <mxGeometry height="49" width="250" x="-110" y="1229" as="geometry" />
        </mxCell>
        <mxCell id="swAobIZYqp8_NzoMnOO4-56" parent="1" style="shape=umlFrame;dashed=1;pointerEvents=0;dropTarget=0;strokeColor=#B3B3B3;height=20;width=30" value="alt" vertex="1">
          <mxGeometry height="508" width="556" x="2110" y="640" as="geometry" />
        </mxCell>
        <mxCell id="swAobIZYqp8_NzoMnOO4-57" parent="swAobIZYqp8_NzoMnOO4-56" style="text;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;" value="[低价值广告数量 &gt; 广告库数量 × 5%]" vertex="1">
          <mxGeometry height="20" width="526" x="30" as="geometry" />
        </mxCell>
        <mxCell id="swAobIZYqp8_NzoMnOO4-58" parent="swAobIZYqp8_NzoMnOO4-56" style="shape=line;dashed=1;whiteSpace=wrap;verticalAlign=top;labelPosition=center;verticalLabelPosition=middle;align=center;strokeColor=#B3B3B3;" value="[数据正常]" vertex="1">
          <mxGeometry height="4" width="556" y="355" as="geometry" />
        </mxCell>
        <mxCell id="swAobIZYqp8_NzoMnOO4-59" parent="1" style="fillColor=#ffff88;strokeColor=#9E916F;" value="阶段3: 在线广告加载" vertex="1">
          <mxGeometry height="49" width="382" x="490" y="730" as="geometry" />
        </mxCell>
        <mxCell id="swAobIZYqp8_NzoMnOO4-60" parent="1" style="shape=umlFrame;dashed=1;pointerEvents=0;dropTarget=0;strokeColor=#B3B3B3;height=20;width=0" value="" vertex="1">
          <mxGeometry height="358" width="497" x="420" y="730" as="geometry" />
        </mxCell>
        <mxCell id="swAobIZYqp8_NzoMnOO4-61" parent="swAobIZYqp8_NzoMnOO4-60" style="text;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;" value="" vertex="1">
          <mxGeometry height="8.55436081242533" width="497" as="geometry" />
        </mxCell>
        <mxCell id="swAobIZYqp8_NzoMnOO4-62" parent="1" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;container=1;dropTarget=0;collapsible=0;recursiveResize=0;outlineConnect=0;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;vertical&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0};size=65;" value="Recall Redis" vertex="1">
          <mxGeometry height="1792" width="150" x="230" y="20" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
